geom_text(aes(label = crashes_state), position = position_dodge()) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_dodge(width = 1)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_dodge(width = 2)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge(width = 2)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge() +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge()) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge(y=1)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge(y=2)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_fill(y=2)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_fill()) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_fill(vjust=1)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_fill(vjust=2)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_fill(vjust = 0.5)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_stack(vjust = 0.5)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_stack(vjust = 1.5)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_stack(vjust = 1.2)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_stack(vjust = 1.1)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge(vjust = 1.1)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge()) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge(x=0, y=0)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge(x=0, y=1)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge(x=0, y=2)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge(x=0, y=200)) +
theme_bw()
state_accidents %>%
ggplot(mapping = aes(x = STATENAME, y = crashes_state)) +
geom_col() +
ylab("Crashes") +
xlab("") +
ggtitle("Five states with the most fatal crashes") +
geom_text(aes(label = crashes_state), position = position_nudge(x=0, y=150)) +
theme_bw()
month_accidents %>%
ggplot(mapping = aes(x = MONTH, y = crashes_month)) +
geom_col() +
theme_bw() +
ylab("Crashes") +
ggtitle("Fatal crashes by month of the year") +
geom_text(aes(label = crashes_month), position = position_nudge(x=0, y=150)) +
scale_x_continuous(minor_breaks = seq(0 , 100, 5), breaks = seq(0, 12, 1))
accidents1 %>%
group_by(STATENAME) %>%
mutate(crashes = n(),
dr_drivers_state = sum(DRUNK_DR, na.rm = TRUE),
prop_drunk = dr_drivers_state / crashes)->
accidents2
accidents2 %>%
select(STATENAME,prop_drunk) %>%
summarize(prop_drunk) %>%
slice_head %>%
arrange(desc(prop_drunk)) %>%
slice(5)
accidents1 %>%
group_by(STATENAME) %>%
mutate(crashes = n(),
dr_drivers_state = sum(DRUNK_DR, na.rm = TRUE),
prop_drunk = dr_drivers_state / crashes)->
accidents2
accidents2 %>%
select(STATENAME,prop_drunk) %>%
summarize(prop_drunk) %>%
slice_head %>%
arrange(desc(prop_drunk)) %>%
head(5)
accidents1 %>%
group_by(STATENAME) %>%
mutate(crashes = n(),
dr_drivers_state = sum(DRUNK_DR, na.rm = TRUE),
prop_drunk = dr_drivers_state / crashes)->
accidents2
accidents2 %>%
select(STATENAME,prop_drunk) %>%
summarize(prop_drunk) %>%
slice_head %>%
arrange(desc(prop_drunk)) %>%
head(5) %>%
tail(5)
accidents1 %>%
group_by(STATENAME) %>%
mutate(crashes = n(),
dr_drivers_state = sum(DRUNK_DR, na.rm = TRUE),
prop_drunk = dr_drivers_state / crashes)->
accidents2
accidents2 %>%
select(STATENAME,prop_drunk) %>%
summarize(prop_drunk) %>%
slice_head %>%
arrange(desc(prop_drunk)) %>%
head(5)
accidents2 %>%
select(STATENAME,prop_drunk) %>%
summarize(prop_drunk) %>%
slice_head %>%
arrange(desc(prop_drunk)) %>%
tail(5)
accidents1 %>%
group_by(STATENAME) %>%
mutate(crashes = n(),
dr_drivers_state = sum(DRUNK_DR, na.rm = TRUE),
prop_drunk = dr_drivers_state / crashes)->
accidents2
accidents2 %>%
select(STATENAME,prop_drunk) %>%
summarize(prop_drunk) %>%
slice_head %>%
arrange(desc(prop_drunk)) %>%
head(5) ->
drunk_states_high
accidents2 %>%
select(STATENAME,prop_drunk) %>%
summarize(prop_drunk) %>%
slice_head %>%
arrange(desc(prop_drunk)) %>%
tail(5) ->
drunk_states_low
total <- rbind(drunk_states_high, drunk_states_low)
accidents2 %>%
select(STATENAME,prop_drunk) %>%
summarize(prop_drunk) %>%
slice_head %>%
arrange(desc(prop_drunk)) %>%
tail(5) ->
drunk_states_low
total <- rbind(drunk_states_high, drunk_states_low)
total
total %>%
ggplot(mapping = aes(x = STATENAME, y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(round(label = prop_drunk, digits = 3)), position = position_nudge(x=0, y=125)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = STATENAME, y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = prop_drunk), position = position_nudge(x=0, y=125)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = STATENAME, y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = prop_drunk), position = position_fill(vjust = 1))) +
total %>%
ggplot(mapping = aes(x = STATENAME, y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = prop_drunk), position = position_fill(vjust = 1)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = STATENAME, y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = prop_drunk), position = position_fill(vjust = .1)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = STATENAME, y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = prop_drunk), position = position_fill(vjust = .5)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = STATENAME, y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = prop_drunk), position = position_stack(vjust = .5)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = STATENAME, y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = prop_drunk), position = position_stack(vjust = 1.5)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = prop_drunk), position = position_stack(vjust = 1.5)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_stack(vjust = 1.5)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_stack(vjust = 1.1)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=125)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=1)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=.1)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=.01)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=.03)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col() +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=.02)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col(width = 1) +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=.02)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col(width = 0) +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=.02)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col(width = 0.5) +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=.02)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col(width = 0.5, position = position_dodge(0.7)) +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=.02)) +
theme_bw()
total %>%
ggplot(mapping = aes(x = reorder(STATENAME, -prop_drunk), y = prop_drunk)) +
geom_col(width = 0.75) +
ylab("Proportion of crashes with drunk drivers") +
xlab("") +
ggtitle("States with the highest and lowest proprotion of crashes caused by drun drivers") +
geom_text(aes(label = round(prop_drunk, digits = 3)), position = position_nudge(x=0, y=.02)) +
theme_bw()
accidents2 %>%
select(STATENAME,prop_drunk) %>%
summarize(prop_drunk) %>%
slice_head %>%
arrange(desc(prop_drunk)) %>%
tail(5) ->
drunk_states_low
total <- rbind(drunk_states_high, drunk_states_low)
total
knitr::opts_chunk$set(echo = TRUE)
install.packages("devtools")
install_github("Displayr/flipPlots")
install_github("Displayr/flipPlots")
library(devtools)
library(devtools)
install_github("Displayr/flipPlots")
knitr::opts_chunk$set(echo = TRUE)
library(devtools)
install_github("LukeDJacobsen/WNBAballr")
install.packages("pacman")
knitr::opts_chunk$set(echo = TRUE)
# You can install using the pacman package using the following code:
if (!requireNamespace('pacman', quietly = TRUE)){
install.packages('pacman')
}
pacman::p_load_current_gh("saiemgilani/wehoop")
future::plan("multisession")
tictoc::tic()
future::plan("multisession")
tictoc::tic()
install.packages("tictoc")
#install.packages("tictoc")
tictoc::tic()
progressr::with_progress({
wnba_pbp <- wehoop::load_wnba_pbp(2002:2021)
})
tictoc::toc()
View(wnba_pbp)
library(dplyr)
library(tidyverse)
wnba_pbp %>%
#  group_by(season, away_team_name) %>%
filter(seaon == '2021' & (away_team_name == 'Atlanta') | home_team_name == 'Atlanta')
wnba_pbp %>%
#  group_by(season, away_team_name) %>%
filter(season == '2021' & (away_team_name == 'Atlanta') | home_team_name == 'Atlanta')
wnba_pbp %>%
#  group_by(season, away_team_name) %>%
filter(season == '2021' & (away_team_name == 'Atlanta'))
getwd()
setwd("path")
getwd()
install.packages(c("tidyverse", "broom", "lmtest", "sandwich", "car", "Sleuth3", "palmerpenguins", "quantreg", "ggthemes"))
getwd()
getwd()
setwd("path")
library(gapminder)
gapminder_unfiltered
